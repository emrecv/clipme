<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Clipme</title>
  </head>

  <body>
    <div id="root">
      <style>
        body { background-color: #0a0a0a; margin: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
        .loading-container {
          position: fixed;
          top: 0; left: 0; right: 0; bottom: 0;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          background-color: #0a0a0a;
          color: white;
          z-index: 9999;
        }
        .loading-logo {
          width: 64px;
          height: 64px;
          margin-bottom: 16px;
          opacity: 0.8;
          animation: pulse 2s infinite ease-in-out;
        }
        .loading-text {
          font-size: 14px;
          opacity: 0.5;
        }
        @keyframes pulse {
          0% { opacity: 0.5; transform: scale(0.95); }
          50% { opacity: 1; transform: scale(1); }
          100% { opacity: 0.5; transform: scale(0.95); }
        }
      </style>
      <div class="loading-container" id="loading-screen">
        <!-- SVG Logo inline to ensure it loads INSTANTLY -->
        <svg class="loading-logo" viewBox="0 0 360 125" fill="none">
          <path d="M332.464 101.64C315.384 101.64 302.504 87.22 302.504 65.66C302.504 44.66 315.104 29.54 331.484 29.54C346.184 29.54 356.404 41.44 359.204 58.24L316.364 70.28C319.304 83.02 327.284 91.14 337.924 91.14C345.064 91.14 351.784 87.36 356.824 80.64L358.784 84.84C353.884 93.66 345.204 101.64 332.464 101.64ZM315.104 59.08C315.104 61.04 315.244 63 315.384 64.96L345.064 56.42C343.244 45.22 337.924 35.42 329.244 35.42C320.984 35.42 315.104 44.1 315.104 59.08Z" fill="white"/>
          <path d="M280.535 100.24C280.535 98.14 279.835 90.02 277.735 73.92L274.795 51.38C273.675 42.56 270.035 39.06 265.415 39.06C261.355 39.06 257.155 42 250.715 49.56L253.935 100.24H239.095C239.235 98.14 239.095 89.74 238.115 73.64L236.715 51.38C236.295 42.42 231.955 39.06 227.475 39.06C223.275 39.06 218.935 42.14 212.355 50.12V73.64C212.355 89.74 212.495 98.84 212.775 100.24H198.215C198.495 98.84 198.635 89.74 198.635 73.64V52.64C198.635 45.36 198.075 38.92 197.095 32.9L210.675 30.1C211.375 34.16 211.655 38.5 211.935 42.84C220.475 33.18 226.915 29.82 233.355 29.82C240.775 29.82 247.215 34.3 249.735 42.98C258.415 33.32 264.715 29.82 271.855 29.82C280.535 29.82 286.975 35.28 288.795 48.72L295.655 100.24H280.535Z" fill="white"/>
          <path d="M154.343 101.36C150.143 101.36 145.943 100.52 141.463 98.84C141.463 114.1 141.603 122.64 141.883 124.04H127.323C127.603 122.64 127.743 113.54 127.743 97.44V52.64C127.743 45.36 127.183 38.92 126.203 32.9L139.783 30.1C140.343 33.88 140.763 37.8 140.903 41.86C147.063 33.74 154.063 29.82 161.623 29.82C175.763 29.82 185.983 43.68 185.983 63.28C185.983 85.54 172.683 101.36 154.343 101.36ZM141.463 90.72C145.663 94.36 149.863 95.9 154.063 95.9C165.123 95.9 172.263 84.42 172.263 68.18C172.263 51.52 164.843 38.92 155.463 38.92C150.563 38.92 145.803 42.42 141.463 50.26V90.72Z" fill="white"/>
          <path d="M96.4907 100.24C96.7707 98.84 96.9107 89.74 96.9107 73.64V59.36C96.9107 43.26 96.6307 34.16 96.2107 32.9L110.631 30.1V73.64C110.631 89.74 110.771 98.84 111.051 100.24H96.4907ZM93.8307 11.2L103.771 1.25998L113.711 11.2L103.771 20.86L93.8307 11.2Z" fill="white"/>
          <path d="M65.6578 100.24C65.9378 98.84 66.0778 89.74 66.0778 73.64V29.26C66.0778 13.16 65.7978 4.06 65.3778 2.8L79.7978 0V73.64C79.7978 89.74 79.9378 98.84 80.2178 100.24H65.6578Z" fill="white"/>
          <path d="M29.12 101.64C12.6 101.64 0 86.94 0 66.36C0 46.48 11.76 29.68 28.98 29.68C40.18 29.68 49.56 36.54 54.32 51.1L41.16 54.18C38.5 43.4 33.6 35.42 26.46 35.42C18.06 35.42 12.74 45.5 12.74 59.08C12.74 76.58 21.14 91.14 34.44 91.14C41.86 91.14 48.16 86.66 51.94 79.1L54.6 83.02C50.68 92.96 42 101.64 29.12 101.64Z" fill="white"/>
        </svg>
        <div class="loading-text">Initializing...</div>
      </div>
    </div>
    <script>
      // GLOBAL ERROR HANDLING & DEADMAN SWITCH
      (function() {
        var LOAD_TIMEOUT_MS = 8000;
        var appLoaded = false;
        var loadingScreen = document.getElementById('loading-screen');
        
        // 1. Deadman Switch: If app doesn't load in X seconds, show fail screen
        var timeoutId = setTimeout(function() {
          if (!appLoaded) {
            showFatalError("App Timeout: React failed to mount within " + (LOAD_TIMEOUT_MS/1000) + "s", "Likely a Javascript syntax error or module load failure.");
          }
        }, LOAD_TIMEOUT_MS);

        // 2. Global Function for React to call when ready
        window.appLoaded = function() {
          appLoaded = true;
          clearTimeout(timeoutId);
          if (loadingScreen) loadingScreen.style.display = 'none';
          console.log("App loaded successfully!");
        };

        // 3. Global Error Handler (Script errors, SyntaxErrors)
        window.onerror = function(msg, url, line, col, error) {
          showFatalError(msg, "File: " + url + "\nLine: " + line + ":" + col + "\nStack: " + (error ? error.stack : 'N/A'));
          return false; // let default handler run too
        };

        // 4. Unhandled Promise Rejections (Async errors)
        window.onunhandledrejection = function(event) {
          console.error("Unhandled Rejection:", event.reason);
          // Optional: Show error if it looks critical, but maybe too noisy
        };

        function showFatalError(title, details) {
          if (appLoaded) return; // Don't override if app is already running
          
          document.body.innerHTML = `
            <div style="
              position: fixed; top: 0; left: 0; right: 0; bottom: 0;
              background: #1a1a1a; color: white;
              padding: 40px; font-family: monospace;
              display: flex; flex-direction: column;
              align-items: flex-start; justify-content: center;
              z-index: 99999;
            ">
              <h1 style="color: #ff5555; margin-bottom: 20px;">Startup Failure</h1>
              <h2 style="font-size: 18px; margin-bottom: 10px; opacity: 0.9;">${title}</h2>
              <pre style="
                background: #333; padding: 20px; border-radius: 8px;
                width: 100%; overflow: auto; color: #ddd;
                white-space: pre-wrap; word-break: break-all;
                border: 1px solid #555;
              ">${details}</pre>
              <button onclick="window.location.reload()" style="
                margin-top: 30px; padding: 12px 24px;
                background: #E5C009; color: black; border: none;
                font-weight: bold; font-size: 16px; cursor: pointer;
                border-radius: 4px;
              ">Try Reload</button>
            </div>
          `;
        }
      })();
    </script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
